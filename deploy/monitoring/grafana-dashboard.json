{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "datasource": "${DS_PROMETHEUS}",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "fillOpacity": 10 },
          "unit": "percentunit"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 0 },
      "id": 1,
      "title": "Cache Hit Rate",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(warpdrive_cache_hit_total{instance=~\"$instance\"}[5m]) / (rate(warpdrive_cache_hit_total{instance=~\"$instance\"}[5m]) + rate(warpdrive_cache_miss_total{instance=~\"$instance\"}[5m]))",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "datasource": "${DS_PROMETHEUS}",
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 0 },
      "id": 2,
      "title": "Cache Size",
      "type": "timeseries",
      "targets": [
        {
          "expr": "warpdrive_cache_size_bytes{instance=~\"$instance\"}",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "datasource": "${DS_PROMETHEUS}",
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 8 },
      "id": 3,
      "title": "Backend Latency (p99)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "histogram_quantile(0.99, rate(warpdrive_backend_request_duration_seconds_bucket{instance=~\"$instance\"}[5m]))",
          "legendFormat": "{{backend}} / {{operation}}"
        }
      ]
    },
    {
      "datasource": "${DS_PROMETHEUS}",
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 8 },
      "id": 4,
      "title": "Backend Errors",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(warpdrive_backend_errors_total{instance=~\"$instance\"}[5m])",
          "legendFormat": "{{backend}} / {{error_type}}"
        }
      ]
    },
    {
      "datasource": "${DS_PROMETHEUS}",
      "fieldConfig": {
        "defaults": {
          "unit": "Bps"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 16 },
      "id": 5,
      "title": "FUSE Throughput (bytes/s)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(warpdrive_backend_bytes_read_total{instance=~\"$instance\"}[5m])",
          "legendFormat": "{{backend}}"
        }
      ]
    },
    {
      "datasource": "${DS_PROMETHEUS}",
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 16 },
      "id": 6,
      "title": "FUSE Operation Latency (p95)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(warpdrive_fuse_operation_duration_seconds_bucket{instance=~\"$instance\"}[5m]))",
          "legendFormat": "{{operation}}"
        }
      ]
    }
  ],
  "refresh": "10s",
  "schemaVersion": 39,
  "tags": ["warpdrive", "data-fabric", "gpu"],
  "templating": {
    "list": [
      {
        "current": {},
        "datasource": "${DS_PROMETHEUS}",
        "definition": "label_values(warpdrive_cache_hit_total, instance)",
        "name": "instance",
        "query": "label_values(warpdrive_cache_hit_total, instance)",
        "refresh": 2,
        "type": "query",
        "includeAll": true,
        "multi": true
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "title": "WarpDrive Data Fabric",
  "uid": "warpdrive-overview"
}
